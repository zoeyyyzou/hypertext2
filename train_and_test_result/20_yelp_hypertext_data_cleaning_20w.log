HyperText
Loading data...
use min words freq:1
Vocab size: 67398
label size: 2
Finished Data loaded...
Time usage: 0:00:02
hyperparamper config:
model_name=HyperText
train_path=datasets/yelp_hypertext_20w_data_cleaning/train.txt
dev_path=datasets/yelp_hypertext_20w_data_cleaning/dev.txt
test_path=datasets/yelp_hypertext_20w_data_cleaning/test.txt
class_list=['0', '1']
vocab_path=datasets/yelp_hypertext_20w_data_cleaning/vocab.txt
labels_path=datasets/yelp_hypertext_20w_data_cleaning/labels.txt
save_path=output/20_yelp_data_cleaning_200000/HyperText.ckpt
log_path=output/20_yelp_data_cleaning_200000/HyperText.log
embedding_pretrained=None
device=cpu
dropout=0.0
require_improvement=6000
num_classes=2
n_vocab=67398
num_epochs=2
wordNgrams=2
batch_size=50
max_length=1000
learning_rate=0.011
embed=20
bucket=1500000
lr_decay_rate=0.96
<bound method Module.parameters of Model(
  (dropout): Dropout(p=0.0, inplace=False)
  (hyperLinear): MobiusLinear(in_features_size=20, out_features_size=2, curvalture=1.0)
)>
Epoch:1/2
Train Step:      0,  Train Loss: 0.6932,  Train Acc: 42.0000%,  Val Loss: 0.6898,  Val Acc: 81.0775%,  Time: 0:05:48 **
Train Step:     50,  Train Loss: 0.396,  Train Acc: 84.0000%,  Val Loss: 0.4465,  Val Acc: 81.0775%,  Time: 0:17:35 
Train Step:    100,  Train Loss: 0.2683,  Train Acc: 90.0000%,  Val Loss: 0.2972,  Val Acc: 86.2525%,  Time: 0:27:33 **
Train Step:    150,  Train Loss: 0.2592,  Train Acc: 92.0000%,  Val Loss: 0.2394,  Val Acc: 90.2550%,  Time: 0:34:03 **
Train Step:    200,  Train Loss: 0.1437,  Train Acc: 96.0000%,  Val Loss: 0.2239,  Val Acc: 90.7800%,  Time: 0:39:56 **
Train Step:    250,  Train Loss: 0.1888,  Train Acc: 92.0000%,  Val Loss: 0.2152,  Val Acc: 91.3400%,  Time: 0:47:20 **
Train Step:    300,  Train Loss: 0.207,  Train Acc: 90.0000%,  Val Loss: 0.2117,  Val Acc: 91.4550%,  Time: 0:54:19 **
Train Step:    350,  Train Loss: 0.2549,  Train Acc: 86.0000%,  Val Loss: 0.2067,  Val Acc: 91.7725%,  Time: 0:59:40 **
Train Step:    400,  Train Loss: 0.2667,  Train Acc: 90.0000%,  Val Loss: 0.2054,  Val Acc: 91.6225%,  Time: 1:07:12 
Train Step:    450,  Train Loss: 0.2369,  Train Acc: 92.0000%,  Val Loss: 0.2038,  Val Acc: 91.6675%,  Time: 1:14:41 
Train Step:    500,  Train Loss: 0.1908,  Train Acc: 94.0000%,  Val Loss: 0.1997,  Val Acc: 91.9000%,  Time: 1:20:41 **
Train Step:    550,  Train Loss: 0.2384,  Train Acc: 92.0000%,  Val Loss: 0.1976,  Val Acc: 92.0325%,  Time: 1:28:20 **
Train Step:    600,  Train Loss: 0.1403,  Train Acc: 92.0000%,  Val Loss: 0.1961,  Val Acc: 91.9725%,  Time: 1:35:46 
Train Step:    650,  Train Loss: 0.1945,  Train Acc: 94.0000%,  Val Loss: 0.1948,  Val Acc: 92.1600%,  Time: 1:40:58 **
Train Step:    700,  Train Loss: 0.1113,  Train Acc: 96.0000%,  Val Loss: 0.194,  Val Acc: 92.2425%,  Time: 1:47:47 **
Train Step:    750,  Train Loss: 0.1562,  Train Acc: 96.0000%,  Val Loss: 0.1921,  Val Acc: 92.2750%,  Time: 1:54:42 **
Train Step:    800,  Train Loss: 0.275,  Train Acc: 88.0000%,  Val Loss: 0.1921,  Val Acc: 92.2625%,  Time: 2:00:42 
Train Step:    850,  Train Loss: 0.103,  Train Acc: 96.0000%,  Val Loss: 0.1906,  Val Acc: 92.3525%,  Time: 2:07:45 **
Train Step:    900,  Train Loss: 0.3347,  Train Acc: 86.0000%,  Val Loss: 0.1901,  Val Acc: 92.3775%,  Time: 2:14:11 **
Train Step:    950,  Train Loss: 0.2081,  Train Acc: 88.0000%,  Val Loss: 0.1897,  Val Acc: 92.4375%,  Time: 2:20:31 **
Train Step:   1000,  Train Loss: 0.1651,  Train Acc: 92.0000%,  Val Loss: 0.1884,  Val Acc: 92.3725%,  Time: 2:27:43 
Train Step:   1050,  Train Loss: 0.2163,  Train Acc: 90.0000%,  Val Loss: 0.1876,  Val Acc: 92.6425%,  Time: 2:35:02 **
Train Step:   1100,  Train Loss: 0.3138,  Train Acc: 88.0000%,  Val Loss: 0.1865,  Val Acc: 92.5600%,  Time: 2:41:08 
Train Step:   1150,  Train Loss: 0.2015,  Train Acc: 94.0000%,  Val Loss: 0.1859,  Val Acc: 92.6575%,  Time: 2:48:51 **
Train Step:   1200,  Train Loss: 0.1886,  Train Acc: 94.0000%,  Val Loss: 0.1861,  Val Acc: 92.5250%,  Time: 2:55:07 
Train Step:   1250,  Train Loss: 0.2274,  Train Acc: 90.0000%,  Val Loss: 0.1859,  Val Acc: 92.6225%,  Time: 3:01:12 
Train Step:   1300,  Train Loss: 0.2445,  Train Acc: 86.0000%,  Val Loss: 0.1851,  Val Acc: 92.5800%,  Time: 3:08:54 
Train Step:   1350,  Train Loss: 0.1713,  Train Acc: 94.0000%,  Val Loss: 0.1848,  Val Acc: 92.5650%,  Time: 3:15:39 
Train Step:   1400,  Train Loss: 0.159,  Train Acc: 94.0000%,  Val Loss: 0.184,  Val Acc: 92.7400%,  Time: 3:21:23 **
Train Step:   1450,  Train Loss: 0.2922,  Train Acc: 84.0000%,  Val Loss: 0.1834,  Val Acc: 92.7000%,  Time: 3:28:52 
Train Step:   1500,  Train Loss: 0.1192,  Train Acc: 94.0000%,  Val Loss: 0.1835,  Val Acc: 92.7250%,  Time: 3:35:54 
Train Step:   1550,  Train Loss: 0.1265,  Train Acc: 96.0000%,  Val Loss: 0.1832,  Val Acc: 92.6925%,  Time: 3:42:21 
Train Step:   1600,  Train Loss: 0.1861,  Train Acc: 94.0000%,  Val Loss: 0.1825,  Val Acc: 92.7475%,  Time: 3:49:32 **
Train Step:   1650,  Train Loss: 0.1513,  Train Acc: 92.0000%,  Val Loss: 0.182,  Val Acc: 92.7900%,  Time: 3:56:07 **
Train Step:   1700,  Train Loss: 0.2092,  Train Acc: 92.0000%,  Val Loss: 0.1818,  Val Acc: 92.7600%,  Time: 4:01:59 
Train Step:   1750,  Train Loss: 0.09813,  Train Acc: 96.0000%,  Val Loss: 0.1814,  Val Acc: 92.7500%,  Time: 4:09:40 
Train Step:   1800,  Train Loss: 0.1994,  Train Acc: 90.0000%,  Val Loss: 0.181,  Val Acc: 92.7575%,  Time: 4:15:59 
Train Step:   1850,  Train Loss: 0.1629,  Train Acc: 92.0000%,  Val Loss: 0.1806,  Val Acc: 92.8275%,  Time: 4:21:12 **
Train Step:   1900,  Train Loss: 0.1942,  Train Acc: 92.0000%,  Val Loss: 0.1803,  Val Acc: 92.8250%,  Time: 4:24:03 
Train Step:   1950,  Train Loss: 0.1976,  Train Acc: 94.0000%,  Val Loss: 0.1801,  Val Acc: 92.8325%,  Time: 4:26:04 **
Train Step:   2000,  Train Loss: 0.2494,  Train Acc: 92.0000%,  Val Loss:  0.18,  Val Acc: 92.8375%,  Time: 4:28:01 **
Train Step:   2050,  Train Loss: 0.3101,  Train Acc: 88.0000%,  Val Loss: 0.1796,  Val Acc: 92.8700%,  Time: 4:30:04 **
Train Step:   2100,  Train Loss: 0.1697,  Train Acc: 92.0000%,  Val Loss: 0.1792,  Val Acc: 92.9050%,  Time: 4:32:11 **
Train Step:   2150,  Train Loss: 0.2539,  Train Acc: 88.0000%,  Val Loss: 0.1792,  Val Acc: 92.8550%,  Time: 4:34:12 
Train Step:   2200,  Train Loss: 0.2043,  Train Acc: 88.0000%,  Val Loss: 0.1789,  Val Acc: 92.8600%,  Time: 4:36:05 
Train Step:   2250,  Train Loss: 0.1718,  Train Acc: 94.0000%,  Val Loss: 0.1788,  Val Acc: 92.8850%,  Time: 4:38:10 
Train Step:   2300,  Train Loss: 0.1332,  Train Acc: 94.0000%,  Val Loss: 0.1785,  Val Acc: 92.9275%,  Time: 4:40:17 **
Train Step:   2350,  Train Loss: 0.1607,  Train Acc: 94.0000%,  Val Loss: 0.1785,  Val Acc: 92.9225%,  Time: 4:42:13 
Epoch:2/2
Train Step:   2400,  Train Loss: 0.1733,  Train Acc: 92.0000%,  Val Loss: 0.1785,  Val Acc: 92.9275%,  Time: 4:44:37 
Train Step:   2450,  Train Loss: 0.1553,  Train Acc: 96.0000%,  Val Loss: 0.1783,  Val Acc: 92.9125%,  Time: 4:46:32 
Train Step:   2500,  Train Loss: 0.1765,  Train Acc: 92.0000%,  Val Loss: 0.1782,  Val Acc: 92.9125%,  Time: 4:48:35 
Train Step:   2550,  Train Loss: 0.05563,  Train Acc: 100.0000%,  Val Loss: 0.1782,  Val Acc: 92.9250%,  Time: 4:50:38 
Train Step:   2600,  Train Loss: 0.08861,  Train Acc: 98.0000%,  Val Loss: 0.1782,  Val Acc: 92.8800%,  Time: 4:52:34 
Train Step:   2650,  Train Loss: 0.2183,  Train Acc: 92.0000%,  Val Loss: 0.1778,  Val Acc: 92.9425%,  Time: 4:54:39 **
Train Step:   2700,  Train Loss: 0.1223,  Train Acc: 96.0000%,  Val Loss: 0.1779,  Val Acc: 92.9450%,  Time: 4:56:40 **
Train Step:   2750,  Train Loss: 0.2868,  Train Acc: 90.0000%,  Val Loss: 0.178,  Val Acc: 92.9450%,  Time: 4:58:42 
Train Step:   2800,  Train Loss: 0.08236,  Train Acc: 96.0000%,  Val Loss: 0.178,  Val Acc: 92.9350%,  Time: 5:00:40 
Train Step:   2850,  Train Loss: 0.2762,  Train Acc: 84.0000%,  Val Loss: 0.1779,  Val Acc: 92.9600%,  Time: 5:02:42 **
Train Step:   2900,  Train Loss: 0.1262,  Train Acc: 98.0000%,  Val Loss: 0.1779,  Val Acc: 92.9200%,  Time: 5:04:38 
Train Step:   2950,  Train Loss: 0.2128,  Train Acc: 92.0000%,  Val Loss: 0.178,  Val Acc: 92.9175%,  Time: 5:06:30 
Train Step:   3000,  Train Loss: 0.1397,  Train Acc: 92.0000%,  Val Loss: 0.178,  Val Acc: 92.8650%,  Time: 5:08:34 
Train Step:   3050,  Train Loss: 0.1018,  Train Acc: 96.0000%,  Val Loss: 0.178,  Val Acc: 92.9075%,  Time: 5:10:34 
Train Step:   3100,  Train Loss: 0.2476,  Train Acc: 90.0000%,  Val Loss: 0.1781,  Val Acc: 92.8975%,  Time: 5:12:33 
Train Step:   3150,  Train Loss: 0.1281,  Train Acc: 96.0000%,  Val Loss: 0.1781,  Val Acc: 92.8925%,  Time: 5:14:33 
Train Step:   3200,  Train Loss: 0.1707,  Train Acc: 94.0000%,  Val Loss: 0.178,  Val Acc: 92.9000%,  Time: 5:16:38 
Train Step:   3250,  Train Loss: 0.2092,  Train Acc: 88.0000%,  Val Loss: 0.178,  Val Acc: 92.8950%,  Time: 5:18:37 
Train Step:   3300,  Train Loss: 0.1754,  Train Acc: 92.0000%,  Val Loss: 0.1782,  Val Acc: 92.8900%,  Time: 5:20:31 
Train Step:   3350,  Train Loss: 0.1356,  Train Acc: 98.0000%,  Val Loss: 0.1782,  Val Acc: 92.9300%,  Time: 5:22:35 
Train Step:   3400,  Train Loss: 0.1769,  Train Acc: 92.0000%,  Val Loss: 0.1781,  Val Acc: 92.9625%,  Time: 5:24:42 **
Train Step:   3450,  Train Loss: 0.2498,  Train Acc: 86.0000%,  Val Loss: 0.1781,  Val Acc: 92.9275%,  Time: 5:26:39 
Train Step:   3500,  Train Loss: 0.06681,  Train Acc: 98.0000%,  Val Loss: 0.1781,  Val Acc: 92.9150%,  Time: 5:28:36 
Train Step:   3550,  Train Loss: 0.2025,  Train Acc: 92.0000%,  Val Loss: 0.1783,  Val Acc: 92.9075%,  Time: 5:30:38 
Train Step:   3600,  Train Loss: 0.1732,  Train Acc: 92.0000%,  Val Loss: 0.1782,  Val Acc: 92.9125%,  Time: 5:32:44 
Train Step:   3650,  Train Loss: 0.1971,  Train Acc: 90.0000%,  Val Loss: 0.1782,  Val Acc: 92.9425%,  Time: 5:34:37 
Train Step:   3700,  Train Loss: 0.1595,  Train Acc: 96.0000%,  Val Loss: 0.1782,  Val Acc: 92.9375%,  Time: 5:36:35 
Train Step:   3750,  Train Loss: 0.1672,  Train Acc: 94.0000%,  Val Loss: 0.1783,  Val Acc: 92.9100%,  Time: 5:38:28 
Train Step:   3800,  Train Loss:  0.15,  Train Acc: 92.0000%,  Val Loss: 0.1783,  Val Acc: 92.8925%,  Time: 5:40:20 
Train Step:   3850,  Train Loss: 0.2275,  Train Acc: 90.0000%,  Val Loss: 0.1783,  Val Acc: 92.9200%,  Time: 5:42:17 
Train Step:   3900,  Train Loss: 0.07459,  Train Acc: 98.0000%,  Val Loss: 0.1783,  Val Acc: 92.9100%,  Time: 5:44:14 
Train Step:   3950,  Train Loss: 0.1854,  Train Acc: 92.0000%,  Val Loss: 0.1783,  Val Acc: 92.9200%,  Time: 5:46:09 
Train Step:   4000,  Train Loss: 0.05974,  Train Acc: 98.0000%,  Val Loss: 0.1783,  Val Acc: 92.9350%,  Time: 5:48:06 
Train Step:   4050,  Train Loss: 0.08045,  Train Acc: 98.0000%,  Val Loss: 0.1783,  Val Acc: 92.9375%,  Time: 5:50:03 
Train Step:   4100,  Train Loss: 0.2099,  Train Acc: 94.0000%,  Val Loss: 0.1784,  Val Acc: 92.9375%,  Time: 5:51:58 
Train Step:   4150,  Train Loss: 0.1129,  Train Acc: 96.0000%,  Val Loss: 0.1783,  Val Acc: 92.9075%,  Time: 5:53:52 
Train Step:   4200,  Train Loss: 0.2296,  Train Acc: 90.0000%,  Val Loss: 0.1783,  Val Acc: 92.9425%,  Time: 5:55:44 
Train Step:   4250,  Train Loss: 0.1318,  Train Acc: 94.0000%,  Val Loss: 0.1783,  Val Acc: 92.9300%,  Time: 5:57:42 
Train Step:   4300,  Train Loss: 0.1506,  Train Acc: 92.0000%,  Val Loss: 0.1783,  Val Acc: 92.9175%,  Time: 5:59:36 
Train Step:   4350,  Train Loss: 0.1939,  Train Acc: 94.0000%,  Val Loss: 0.1783,  Val Acc: 92.9250%,  Time: 6:01:30 
Train Step:   4400,  Train Loss: 0.1103,  Train Acc: 94.0000%,  Val Loss: 0.1783,  Val Acc: 92.9200%,  Time: 6:03:25 
Train Step:   4450,  Train Loss: 0.1358,  Train Acc: 94.0000%,  Val Loss: 0.1783,  Val Acc: 92.9200%,  Time: 6:05:23 
Train Step:   4500,  Train Loss: 0.2287,  Train Acc: 90.0000%,  Val Loss: 0.1783,  Val Acc: 92.9225%,  Time: 6:07:15 
Train Step:   4550,  Train Loss: 0.2106,  Train Acc: 92.0000%,  Val Loss: 0.1783,  Val Acc: 92.9400%,  Time: 6:09:07 
Train Step:   4600,  Train Loss: 0.1231,  Train Acc: 96.0000%,  Val Loss: 0.1783,  Val Acc: 92.9225%,  Time: 6:11:07 
Train Step:   4650,  Train Loss: 0.1169,  Train Acc: 94.0000%,  Val Loss: 0.1783,  Val Acc: 92.9500%,  Time: 6:13:06 
Train Step:   4700,  Train Loss: 0.08195,  Train Acc: 96.0000%,  Val Loss: 0.1783,  Val Acc: 92.9425%,  Time: 6:14:56 
Train Step:   4750,  Train Loss: 0.1002,  Train Acc: 94.0000%,  Val Loss: 0.1783,  Val Acc: 92.9275%,  Time: 6:16:52 
Test Loss:  0.18,  Test Acc: 92.88%
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

           0     0.8387    0.7731    0.8046      7580
           1     0.9479    0.9652    0.9565     32420

    accuracy                         0.9288     40000
   macro avg     0.8933    0.8692    0.8805     40000
weighted avg     0.9272    0.9288    0.9277     40000

Confusion Matrix...
[[ 5860  1720]
 [ 1127 31293]]
Test Time: 0:00:23
